{
  "type": "aws",
  "httpMethod": "POST",
  "uri": "arn:aws:apigateway:${AWS_REGION}:dynamodb:action/UpdateItem",
  "credentials": "${API_GATEWAY_DYNAMODB_ROLE}",
  "responses": {
    "default": {
      "statusCode": "200",
      "responseParameters": {
        "method.response.header.Access-Control-Allow-Methods": "'PATCH'",
        "method.response.header.Access-Control-Allow-Headers": "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'",
        "method.response.header.Access-Control-Allow-Origin": "'*'"
      },
      "responseTemplates": {
        "application/json": "{\n  \"message\": \"User updated successfully\"\n}"
      }
    }
  },
  "requestTemplates": {
    "application/json": "#set($inputRoot = $input.path('$'))\n{\n  \"TableName\": \"${DYNAMODB_TABLE_NAME}\",\n  \"Key\": {\n    \"PK\": {\n      \"S\": \"USER#$context.authorizer.claims['custom:userId']\"\n    },\n    \"SK\": {\n      \"S\": \"PROFILE\"\n    }\n  },\n  #set($updateExpression = \"SET\")\n\n  #if($inputRoot.phoneNumbers != '')\n    #if($updateExpression != \"SET\") \n      #set($updateExpression = \"$updateExpression,\")\n    #end\n    #set($updateExpression = \"$updateExpression phoneNumbers = :phoneNumbers\")\n  #end\n\n  #if($inputRoot.fullName != '')\n    #if($updateExpression != \"SET\") \n      #set($updateExpression = \"$updateExpression,\")\n    #end\n    #set($updateExpression = \"$updateExpression fullName = :fullName\")\n  #end\n\n  #if($inputRoot.bloodGroup != '')\n    #if($updateExpression != \"SET\") \n      #set($updateExpression = \"$updateExpression,\")\n    #end\n    #set($updateExpression = \"$updateExpression bloodGroup = :bloodGroup\")\n  #end\n\n  #if($inputRoot.lastDonationDate != '')\n    #if($updateExpression != \"SET\") \n      #set($updateExpression = \"$updateExpression,\")\n    #end\n    #set($updateExpression = \"$updateExpression lastDonationDate = :lastDonationDate\")\n  #end\n\n  #if($inputRoot.height != '')\n    #if($updateExpression != \"SET\") \n      #set($updateExpression = \"$updateExpression,\")\n    #end\n    #set($updateExpression = \"$updateExpression height = :height\")\n  #end\n\n  #if($inputRoot.weight != '')\n    #if($updateExpression != \"SET\") \n      #set($updateExpression = \"$updateExpression,\")\n    #end\n    #set($updateExpression = \"$updateExpression weight = :weight\")\n  #end\n\n  #if($inputRoot.gender != '')\n    #if($updateExpression != \"SET\") \n      #set($updateExpression = \"$updateExpression,\")\n    #end\n    #set($updateExpression = \"$updateExpression gender = :gender\")\n  #end\n\n  #if($inputRoot.dateOfBirth != '')\n    #if($updateExpression != \"SET\") \n      #set($updateExpression = \"$updateExpression,\")\n    #end\n    #set($updateExpression = \"$updateExpression dateOfBirth = :dateOfBirth\")\n  #end\n\n  #if($inputRoot.age != '')\n    #if($updateExpression != \"SET\") \n      #set($updateExpression = \"$updateExpression,\")\n    #end\n    #set($updateExpression = \"$updateExpression age = :age\")\n  #end\n\n  #if($inputRoot.area != '')\n    #if($updateExpression != \"SET\") \n      #set($updateExpression = \"$updateExpression,\")\n    #end\n    #set($updateExpression = \"$updateExpression area = :area\")\n  #end\n\n  #if($inputRoot.city != '')\n    #if($updateExpression != \"SET\") \n      #set($updateExpression = \"$updateExpression,\")\n    #end\n    #set($updateExpression = \"$updateExpression city = :city\")\n  #end\n\n  #if($inputRoot.latitude != '')\n    #if($updateExpression != \"SET\") \n      #set($updateExpression = \"$updateExpression,\")\n    #end\n    #set($updateExpression = \"$updateExpression latitude = :latitude\")\n  #end\n\n  #if($inputRoot.longitude != '')\n    #if($updateExpression != \"SET\") \n      #set($updateExpression = \"$updateExpression,\")\n    #end\n    #set($updateExpression = \"$updateExpression longitude = :longitude\")\n  #end\n\n  #if($inputRoot.geohash != '')\n    #if($updateExpression != \"SET\") \n      #set($updateExpression = \"$updateExpression,\")\n    #end\n    #set($updateExpression = \"$updateExpression geohash = :geohash\")\n  #end\n\n  #if($inputRoot.donationStatus != '')\n    #if($updateExpression != \"SET\") \n      #set($updateExpression = \"$updateExpression,\")\n    #end\n    #set($updateExpression = \"$updateExpression donationStatus = :donationStatus\")\n  #end\n\n  #if($inputRoot.NIDFront != '')\n    #if($updateExpression != \"SET\") \n      #set($updateExpression = \"$updateExpression,\")\n    #end\n    #set($updateExpression = \"$updateExpression NIDFront = :NIDFront\")\n  #end\n\n  #if($inputRoot.NIDBack != '')\n    #if($updateExpression != \"SET\") \n      #set($updateExpression = \"$updateExpression,\")\n    #end\n    #set($updateExpression = \"$updateExpression NIDBack = :NIDBack\")\n  #end\n\n  #if($inputRoot.lastVaccinatedDate != '')\n    #if($updateExpression != \"SET\") \n      #set($updateExpression = \"$updateExpression,\")\n    #end\n    #set($updateExpression = \"$updateExpression lastVaccinatedDate = :lastVaccinatedDate\")\n  #end\n\n  \"UpdateExpression\": \"$updateExpression\",\n  \"ExpressionAttributeValues\": {\n    #if($inputRoot.phoneNumbers != '')\n      #if(!$isFirst),#end\n    \":phoneNumbers\": {\n      \"L\": [\n        #foreach($phone in $inputRoot.phoneNumbers)\n        #if(!$isFirstPhone),#end\n        {\n          \"S\": \"$phone\"\n        }\n        #set($isFirstPhone = false)\n        #end\n      ]\n    }\n    #set($isFirst = false)\n    #end\n\n    #if($inputRoot.fullName != '')\n      #if(!$isFirst),#end\n    \":fullName\": {\n      \"S\": \"$inputRoot.fullName\"\n    }\n    #set($isFirst = false)\n    #end\n\n    #if($inputRoot.bloodGroup != '')\n      #if(!$isFirst),#end\n    \":bloodGroup\": {\n      \"S\": \"$inputRoot.bloodGroup\"\n    }\n    #set($isFirst = false)\n    #end\n\n    #if($inputRoot.lastDonationDate != '')\n      #if(!$isFirst),#end\n    \":lastDonationDate\": {\n      \"S\": \"$inputRoot.lastDonationDate\"\n    }\n    #set($isFirst = false)\n    #end\n\n    #if($inputRoot.height != '')\n      #if(!$isFirst),#end\n    \":height\": {\n      \"N\": \"$inputRoot.height\"\n    }\n    #set($isFirst = false)\n    #end\n\n    #if($inputRoot.weight != '')\n      #if(!$isFirst),#end\n    \":weight\": {\n      \"N\": \"$inputRoot.weight\"\n    }\n    #set($isFirst = false)\n    #end\n\n    #if($inputRoot.gender != '')\n      #if(!$isFirst),#end\n    \":gender\": {\n      \"S\": \"$inputRoot.gender\"\n    }\n    #set($isFirst = false)\n    #end\n\n    #if($inputRoot.dateOfBirth != '')\n      #if(!$isFirst),#end\n    \":dateOfBirth\": {\n      \"S\": \"$inputRoot.dateOfBirth\"\n    }\n    #set($isFirst = false)\n    #end\n\n    #if($inputRoot.age != '')\n      #if(!$isFirst),#end\n    \":age\": {\n      \"N\": \"$inputRoot.age\"\n    }\n    #set($isFirst = false)\n    #end\n\n    #if($inputRoot.area != '')\n      #if(!$isFirst),#end\n    \":area\": {\n      \"S\": \"$inputRoot.area\"\n    }\n    #set($isFirst = false)\n    #end\n\n    #if($inputRoot.city != '')\n      #if(!$isFirst),#end\n    \":city\": {\n      \"S\": \"$inputRoot.city\"\n    }\n    #set($isFirst = false)\n    #end\n\n    #if($inputRoot.latitude != '')\n      #if(!$isFirst),#end\n    \":latitude\": {\n      \"N\": \"$inputRoot.latitude\"\n    }\n    #set($isFirst = false)\n    #end\n\n    #if($inputRoot.longitude != '')\n      #if(!$isFirst),#end\n    \":longitude\": {\n      \"N\": \"$inputRoot.longitude\"\n    }\n    #set($isFirst = false)\n    #end\n\n    #if($inputRoot.geohash != '')\n      #if(!$isFirst),#end\n    \":geohash\": {\n      \"S\": \"$inputRoot.geohash\"\n    }\n    #set($isFirst = false)\n    #end\n\n    #if($inputRoot.donationStatus != '')\n      #if(!$isFirst),#end\n    \":donationStatus\": {\n      \"S\": \"$inputRoot.donationStatus\"\n    }\n    #set($isFirst = false)\n    #end\n\n    #if($inputRoot.NIDFront != '')\n      #if(!$isFirst),#end\n    \":NIDFront\": {\n      \"S\": \"$inputRoot.NIDFront\"\n    }\n    #set($isFirst = false)\n    #end\n\n    #if($inputRoot.NIDBack != '')\n      #if(!$isFirst),#end\n    \":NIDBack\": {\n      \"S\": \"$inputRoot.NIDBack\"\n    }\n    #set($isFirst = false)\n    #end\n\n    #if($inputRoot.lastVaccinatedDate != '')\n      #if(!$isFirst),#end\n    \":lastVaccinatedDate\": {\n      \"S\": \"$inputRoot.lastVaccinatedDate\"\n    }\n    #set($isFirst = false)\n    #end\n\n  },\n  \"ReturnValues\": \"UPDATED_NEW\"\n}"
  },
  "passthroughBehavior": "never"
}
